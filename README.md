# Свое S3-хранилище

- поднимает кластер из 4-ех серверов minIO, балансировщик на nginx
- доступ будет по ссылке `localhost:80`, если не менять переменную `NGINX_PORT`

### Запускать

1. сгенерируйте ключи, запустив `gen_keys.sh`
2. перед запуском, надо переименовать `.env.example` в `.env` и заполнить сгенерированными ключами поля (они же будут кредами для доступа с полными правами)
3. далее, запускаем скрипты из корня, ими же и прибиваем, если нужно
4. `-prod` - запустит полноценную систему с балансером и четырьмя серверами, а так же кешем, а `-dev` - просто один сервер minio
5. `stop-` - просто останавливает контейнеры, оставляя данные, `remove-` - удалит и контейнеры и все данные `деструктивно!`

### Взаимодействовать

- можно через собственный встроенный WebUI
- можно через [mcli](https://min.io/download#/)

### Скрипты для работы с сервером

- `mcli_install.sh` - ставит на локаль утилиту mcli (умеет скачивать для MacOS и для Linux, ставит в путь `/usr/local/bin/mcli`, убедитесь, что он доступен из PATH:)
- `mcli_login.sh <name_server>` - логинится к текущему серверу, переменная с доменом `S3_DOMAIN` должна быть заполнена, а сервер должен быть в работе, если не задать имя сервера, будет настроено подключение с именем `minio`

### Скрипты для работы с пользователями

- `mcli_useradd.sh` - создает нового пользователя, генерит ключи, создает в папке users файл с именем = ACCESS_KEY, а внутри записывает SECRET_KEY
- `mcli_userdel.sh <ACCESS_KEY>` - удаляет пользователя из системы, `деструктивно!`, удалит и все бакеты пользователя, удалит файлик с папки users
- `mcli_userinfo.sh <ACCESS_KEY>` - покажет инфо по контретному пользователю
- `mcli_userlist.sh` - покажет всех пользователей в системе

#### PS
- я намеренно переименовываю `mc` в `mcli`, т.к. у меня очень часто где используется файловый менеджер mc, а при установке они начинают противоречить.

#### Автор
   * **Vassiliy Yegorov** - *Initial work* - [vasyakrg](https://github.com/)
